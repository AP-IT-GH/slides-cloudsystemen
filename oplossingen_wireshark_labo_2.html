<h1 id="labo-2">Labo 2</h1>
<h2 id="vragenreeks-1">Vragenreeks 1</h2>
<ol type="1">
<li>3 lagen</li>
<li>fysiek, datalink en netwerk. Onderaan in Wireshark staan 4
protocols, maar ICMP en IP zitten allebei op de netwerklaag. Je hebt
altijd <em>minstens</em> even veel lagen als protocols, want op elke
laag is minstens een protocol actief. Je kan dus ook nooit een
onderliggende laag missen (bijvoorbeeld TCP zonder IP daar onder kan
gewoon niet).</li>
<li>74 bytes / stuk</li>
<li>Hier kan je verschillende antwoorden geven, op voorwaarde dat je ze
goed verklaart. Als je het volledige ICMP-bericht ziet als “payload”,
dan is dit 34 bytes (grootte Ethernetgedeelte en IP-gedeelte). Als je
controle-informatie van ICMP meeneemt, is het 42 bytes.</li>
<li>Gelijkaardig aan de vorige vraag. Als je daar “34” antwoordde, is
het hier 40. Als je daar “42” antwoordde, is het hier 32.</li>
<li>een <code>ping</code></li>
<li>192.168.1.36. Je weet dat dit de client is, omdat het de “Source”
van een “request” is. Let op: voor het volgende pakket is de source
“8.8.8.8”, maar dat is een “reply”.</li>
<li>8.8.8.8</li>
<li>IP(v4)</li>
<li>half duplex (typisch voor request-reply)</li>
</ol>
<h2 id="vragenreeks-2">Vragenreeks 2</h2>
<p>Filteren doe je via de filter <code>ip.addr == ...</code> (waarbij je
zelf een van de betrokken IP-adressen invult.</p>
<p>De HTML kan je terugvinden voor neverSSL.com, maar niet voor
www.ap.be. Voor neverSSL.com ga je op zoek in de HTTP-data. Voor
www.ap.be wordt TLS gebruikt en kan je de data niet inspecteren tenzij
je eerst je pre-master secret key logt of werkt met een extra
certificaat zoals we tijdens de les gedaan hebben met MITMProxy.</p>
<h2 id="vragenreeks-3">Vragenreeks 3</h2>
<p>Het MAC-adres vind je in het gedeelte “Ethernet II” in Wireshark
(want dat is laag 2).</p>
<p>De client is opnieuw de source, dus het adres is
<code>a0:51:0b:4d:0c:b0</code>. De tegenpartij is
<code>a4 b1 e9 a8 18 58</code>.</p>
<p>De client heeft een netwerkkaart van “Intel Corporate” en de
tegenpartij heeft een netwerkkaart van “Technicolor Delivery
Technologies Belgium NV”. Dit kan je vinden op <a
href="https://macvendors.com">macvendors</a>. Drie bytes volstaan voor
de fabrikant.</p>
<p><strong>Merk op: we spreken hier over “tegenpartij” en niet
“server”.</strong> Dat komt omdat de server de eindbestemming is. Omdat
het Ethernetgedeelte op elke tussenstop (buiten een hub) wordt
aangepast, kunnen we het MAC-adres van de server hier nergens
aflezen.</p>
<h1 id="labo-3">Labo 3</h1>
<h2 id="vragenreeks-1-1">Vragenreeks 1</h2>
<ol type="1">
<li>fysiek, datalink, netwerk, transport, applicatie (zie onderaan: het
betreft HTTP)</li>
<li>659 (zie bovenaan)</li>
<li>193.191.180.79 (zie IP-gedeelte)</li>
<li>f4:b7:e2:77:25:5e (zie Ethernetgedeelte)</li>
<li>80 (zie TCP-gedeelte)</li>
<li>HTTP</li>
<li>1.1 (zie start pakket, behoort standaard formaat van een
HTTP-pakket)</li>
<li>www.bpost.be/nl/faqs (host + pad, <strong>niet</strong>
“Referer”)</li>
<li>GET</li>
<li>9 (tellen vanaf gedeelte “Host” tot (lege) body)</li>
<li>Geen. Er zijn headers, maar de body is leeg. Je ziet dat omdat
<code>\r\n</code> overeenstemt met de laatste twee bytes op de
rechterzijde in de hexadecimale vorm.</li>
</ol>
<h2 id="vragenreeks-2-1">Vragenreeks 2</h2>
<ol type="1">
<li>Dit doe je door gewoon “http” in te typen (zonder quotes).</li>
<li>www.kowaja.be (zie “Host” header)</li>
<li>header.html, content.html, ruler.gif, dtree.css, folder.gif,
joinbottom.gif (allemaal (mogelijk onrechtstreeks) vermeld in het eerste
antwoord)</li>
<li>dtree.css (zie pakket 26)</li>
<li>404</li>
<li>(is geen vraag met een antwoord, maar maakt de volgende zaken
makkelijker af te lezen)</li>
<li>2 juni 2004</li>
<li>27 september 2019</li>
<li>centaur</li>
<li>kowaja@pandora.be</li>
</ol>
<h2 id="vragenreeks-3-1">Vragenreeks 3</h2>
<ol type="1">
<li>7 (de pagina en de embedded content)</li>
<li>nee</li>
<li>dtree.css (zie vorige reeks)</li>
<li>404, dus de gevraagde file bestaat niet (meer) of de naam is fout
geschreven</li>
<li>ruler.gif</li>
<li>image viewer</li>
<li>pakket 23</li>
</ol>
<h2 id="vragenreeks-4">Vragenreeks 4</h2>
<ol type="1">
<li>is geen vraag</li>
<li>is geen vraag</li>
<li>gebruik:
<code>curl -X POST "https://httpbin.org/post" -H  "accept: application/json"</code></li>
<li>is geen vraag</li>
<li>is geen vraag</li>
<li>het moet een HTTP2-server zijn, want er wordt gebruik gemaakt van
TLS 1.2.</li>
</ol>
<h2 id="vragenreeks-5">Vragenreeks 5</h2>
<ol type="1">
<li>schrijf in de balk:
<code>ip.addr eq 192.168.1.47 and ip.addr eq 52.114.128.75</code>. Je
kan dit ook krijgen via rechterklik.</li>
<li>pakket 1 bevat de “client hello”. De TCP-handshake is al eerder
gedaan. pakketten 2 tot en met 6 <strong>samen</strong> vormen de Server
hello, bevatten het certificaat en de “server hello done”. Pakket 7:
client key exchange en eerste change cipher spec. “Finished” is niet
aangeduid in Wireshark. Pakket 8 bevat de change cipher spec in de
omgekeerde richting. Vanaf pakket 9 stemt overeen met het onderdeel
“data transmission”.</li>
<li>TLS 1.2</li>
<li>TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,
TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,
TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (zie “Cipher suites” in de
“hello”)</li>
<li>TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384 (zie “Server Hello”, onderdeel
“Cipher Suite”, waarin een keuze gemaakt wordt uit de aangeboden
opties)</li>
<li>www.digicert.com (de “issuer” van het certificaat)</li>
<li>TLS 1.3</li>
<li>ja, alles vanaf TLS 1.0 tot en met 1LS 1.3 (zie “Extension:
supported_versions” in de “client hello”)</li>
<li>TLS_AES_128_GCM_SHA256, TLS_AES_256_GCM_SHA384,
TLS_CHACHA20_POLY1305_SHA256 (zie opnieuw “Cipher suites” in de
“hello”)</li>
<li>pakket 21</li>
</ol>
